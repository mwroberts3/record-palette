!function(e){var t={};function n(o){if(t[o])return t[o].exports;var a=t[o]={i:o,l:!1,exports:{}};return e[o].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(o,a,function(t){return e[t]}.bind(null,a));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t){const n=document.querySelector(".logged-in-options"),o=document.querySelector(".username"),a=document.querySelector(".folder-id"),r=document.querySelector(".user-msg"),l=document.querySelector(".logged-out-options"),c=document.querySelector(".logout"),i=document.querySelector(".download-images"),s=document.querySelector("#image-size"),d=document.querySelector(".logged-in-username"),m=document.getElementById("show-caption"),u=document.getElementById("sort-by"),g=document.querySelector(".login-download-container"),f=document.querySelector(".image-container");let p=[],v=[],h="",y="",b={tiny:{min:75,max:150},small:{min:125,max:250},medium:{min:250,max:500},large:{min:400,max:800},huge:{min:700,max:1400}};async function S(){y||(y=0);const e=await fetch(`https://api.discogs.com/users/${h}/collection/folders/${y}/releases?token=ofXwtIhxmQZTDufjImxFCCHkeucHvlUoXRirlyvQ`),t=await e.json();if(console.log(t),console.log(e),404===e.status)r.textContent="username not found";else{localStorage.setItem("username",h),l.classList.add("hidden"),n.classList.remove("hidden"),c.classList.add("logged-in-btn"),d.textContent=""+h,r.textContent="",g.classList.add("thin"),console.log(t.releases.length);for(let e=0;e<t.releases.length;e++)v.push(t.releases[e].basic_information.cover_image),p.push(t.releases[e]);x(),console.log(p),i.addEventListener("click",E)}}function x(){let e=window.matchMedia("(max-width: 420px)"),t=window.matchMedia("(max-width: 740px)");f.style["grid-template-columns"]=`repeat(auto-fill, minmax(${b[s.value].min}px, 1fr))`,(e.matches&&"large"===s.value||e.matches&&"huge"===s.value)&&(f.style["grid-template-columns"]="1fr"),t.matches&&"huge"===s.value&&(f.style["grid-template-columns"]="1fr"),console.log(document.querySelectorAll(".cover-img")),f.classList.forEach(e=>{"image-container"!==e&&f.classList.remove(e)}),f.classList.add(""+s.value),localStorage.setItem("imageSize",s.value),L()}function L(){"artist"===u.value&&p.sort((e,t)=>e.basic_information.artists[0].name>t.basic_information.artists[0].name?1:t.basic_information.artists[0].name>e.basic_information.artists[0].name?-1:0),"album"===u.value&&p.sort((e,t)=>e.basic_information.title>t.basic_information.title?1:t.basic_information.title>e.basic_information.title?-1:0),"date-added"===u.value&&p.sort((e,t)=>e.date_added>t.date_added?1:t.date_added>e.date_added?-1:0),localStorage.setItem("sortBy",u.value),_()}function _(){f.innerHTML="";let e=0;p.forEach(t=>{const n=document.createElement("div");n.classList.add("album-container");const o=document.createElement("div");if(o.classList.add("cover-img"),o.style.background=`url("${t.basic_information.cover_image}") no-repeat center center/cover`,n.appendChild(o),m.checked){const t=document.createElement("div");t.classList.add("album-caption");const o=document.createElement("p");o.textContent=`"${p[e].basic_information.title}"`,t.appendChild(o);const a=document.createElement("p");a.textContent=""+p[e].basic_information.artists[0].name,t.appendChild(a),n.appendChild(t),localStorage.setItem("captions","checked"),e++}else m.checked||localStorage.setItem("captions","not checked");f.appendChild(n)}),function(){let e=0;f.childNodes.forEach(t=>{t.setAttribute("id",""+e),e++}),f.addEventListener("click",e=>{console.log(e.target.parentElement),console.log(p[e.target.parentElement.id])})}()}async function E(){let e=0;const t=setInterval(()=>{axios({url:v[e],method:"GET",responseType:"blob"}).then(n=>{const o=window.URL.createObjectURL(new Blob([n.data])),a=document.createElement("a");a.href=o,a.setAttribute("download","cover.jpg"),document.body.appendChild(a),a.click(),e++,console.log(p.length,e),e>p.length&&clearInterval(t)})},750)}localStorage.getItem("username")&&(l.innerHTML="",l.classList.add("user-msg"),l.textContent="...loading collection",h=localStorage.getItem("username"),localStorage.getItem("imageSize")&&(s.value=localStorage.getItem("imageSize")),localStorage.getItem("sortBy")&&(u.value=localStorage.getItem("sortBy")),"checked"===localStorage.getItem("captions")&&(m.checked=!0),S()),o.addEventListener("change",()=>{h=o.value.trim()}),g.addEventListener("submit",e=>{e.preventDefault(),""===h?r.textContent="please enter username":S()}),a.addEventListener("change",()=>{y=a.value.trim()}),s.addEventListener("change",()=>{f.innerHTML="",x()}),m.addEventListener("click",_),c.addEventListener("click",()=>{localStorage.removeItem("username"),location.reload()}),u.addEventListener("change",()=>{L()})}]);